# プロジェクト構成

本プロジェクトでは、**FLOCSS設計**をベースとしたSCSSと、**gulpによる自動化タスク**を活用しています。開発・本番ビルドを効率化し、CSS/JS/画像の最適化やキャッシュバスティングを含めたワークフローを構築しています。

## CSS設計

SCSSのコーディング指針として、CSS設計のひとつである **「FLOCSS」** を採用しています。

[FLOCSS公式](https://github.com/hiloki/flocss)

## 初回セットアップ

### 1. 必要なソフトウェアのインストール

以下のソフトウェアが必要です：

#### Node.jsのインストール
1. [Node.js公式サイト](https://nodejs.org/)にアクセス
2. 「LTS版」（推奨版）をダウンロードしてインストール
3. インストール後、コマンドプロンプト（またはターミナル）で以下を実行して確認：
   ```bash
   node -v

   npm -v
   ```

### 2. WordPressテーマの準備

#### 新規テーマとして開発する場合
1. WordPressの `wp-content/themes/` フォルダに新しいフォルダを作成
   - 例：`wp-content/themes/my-custom-theme/`
2. 作成したフォルダ内でこのプロジェクトをセットアップ

#### 既存テーマを編集する場合
1. WordPressの管理画面から「外観 > テーマ」で対象テーマを確認
2. `wp-content/themes/[テーマ名]/` フォルダを開く
3. **重要：バックアップを作成してから作業してください**
4. テーマの中身を削除

### 3. プロジェクトファイルの配置

1. このリポジトリをダウンロードまたはクローン
2. テーマフォルダ内に以下のファイル・フォルダを配置：
   ```
   your-theme/
   ├── gulpfile.js
   ├── package.json
   ├── src/ (SCSS、JS、画像の開発用ファイル)
   ├── assets/ (コンパイル後の公開用ファイル)
   └── その他のテーマファイル（index.php など）
   ```

### 4. 環境構築

#### パッケージインストール
テーマフォルダ内でコマンドプロンプト（またはターミナル）を開き、以下を実行：

```bash
npm install
```

## 環境構築

パッケージがインストールできたら本番環境のセットアップを構築してください。

```bash
npx gulp build
```

## 開発の始め方

### 開発サーバーの起動

```bash
npx gulp dev
```

これを実行すると：
- SCSS / JS / 画像 / PHP ファイルを変更すると自動で本番環境のファイルへ更新されます。

### ファイルの編集場所

開発時は `src/` フォルダ内のファイルを編集してください：

```
src/
├── scss/          ← CSSの代わりにこちらを編集
├── js/            ← JavaScriptファイル
└── images/        ← 画像ファイル
```

**重要：** `assets/` フォルダ内のファイルは自動生成されるため、直接編集しないでください。

### 開発を終了する場合

コマンドプロンプト（ターミナル）で `Cmd(Ctrl) + C` を押して終了してください。


## よくあるトラブルと解決方法

### 「npm が認識されません」エラー
- Node.jsが正しくインストールされていません
- Node.jsを再インストールしてください

### CSSが反映されない
- `npx gulp dev` が実行されているか確認してください
- ブラウザのキャッシュをクリアしてください（Cmd+Shift+R または Ctrl+Shift+R）

### コマンドが実行できない
- コマンドプロンプト（ターミナル）がテーマフォルダ内で開かれているか確認してください
- `cd` コマンドで正しいフォルダに移動してください

## 詳細な技術仕様

### 主な処理内容

#### SCSS
- Dart Sass でコンパイル
- Autoprefixer によるベンダープレフィックス付与
- css-declaration-sorter によるプロパティ整列
- gulp-merge-media-queries でメディアクエリをまとめる
- minify版（`.min.css`）を自動生成

#### JavaScript
- 公開用フォルダにコピー
- Uglify による圧縮＋minify版（`.min.js`）を自動生成

#### 画像
- JPG/PNGを1920px以内にリサイズし、`.webp`形式に変換
- SVGはそのままコピー


### 利用可能なコマンド一覧

| コマンド | 内容 | 使用場面 |
|---------|------|----------|
| `npx gulp dev` | 開発サーバー起動（自動リロード） | 日常の開発作業 |
| `npx gulp build` | 本番ビルド | サイト公開前 |
| `npx gulp cache` | キャッシュバスティング | CSS/JSが更新されない場合 |
| `npx gulp minJs` | JS圧縮 | JavaScriptのみ圧縮したい場合 |
| `npx gulp minImage` | 画像最適化 | 画像のみ最適化したい場合 |